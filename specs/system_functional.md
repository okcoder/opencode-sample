# meet-navi 機能仕様書

---

## 1. 製品概要

| 項目 | 内容 |
|------|------|
| 製品名 | meet-navi |
| 一言タグライン | Google Calendar ミーティングアシスタント |
| コアバリュー | 本日のミーティングを自動取得し、ビデオ会議を識別し、ユーザーに事前に通知 |
| ターゲットユーザー | Google Calendar を頻繁に使用するビジネスパーソン |

---

## 2. 機能リスト

### 2.1 コア機能

| 機能名 | 機能説明 | 優先度 | 複雑度 |
|--------|---------|:------:|:------:|
| 本日イベント表示 | トレイアイコンに本日の開始前/進行中ミーティングを表示 | P0 | 中 |
| ビデオ会議識別 | Google Meet/Zoom/Teams ミーティングを自動識別してリンク抽出 | P0 | 低 |
| ポップアップ通知 | ミーティング開始90秒前にポップアップを表示 | P0 | 中 |
| ワンクリック参加 | 「今すぐ参加」ボタンでビデオ会議を直接開く | P0 | 低 |
| イベント更新 | トレイpopupに更新ボタンを表示、手動で再取得 | P0 | 低 |

### 2.2 補助機能

| 機能名 | 機能説明 | 備考 |
|--------|---------|------|
| 自動ログイン検出 | Google Calendar ログインアカウントを自動識別 | 任意 |
| 自動更新 | 一定間隔でイベントリストを自動更新 | 実装済み |
| 重複通知防止 | 同一ミーティングは1回のみ通知 | 実装済み |
| 永続化 | 通知済みミーティングを記憶、再起動後も重複通知なし | 実装済み |

---

## 3. 機能詳細説明

### 3.1 本日イベント表示

**トリガー**：ユーザーがシステムトレイアイコンをクリック

**表示内容**：
- 進行中ミーティング：「[進行中] ミーティング名」
- 未開始ミーティング：「[未開始] ミーティング名」
- イベントなし：ログインメールアドレスまたは「イベントなし」

**トレイの動作**：
- macOS：トレイタイトルに最初の候補イベントを表示
- Windows/Linux：Tooltipにすべての候補イベントを表示

---

### 3.2 ビデオ会議識別

**認識されるミーティングタイプ**：

| タイプ | 認識ルール | 抽出フィールド |
|--------|-----------|---------------|
| Google Meet | conferenceData.entryPoints で entryPointType === 'video' | videoUrl, videoId |
| Zoom | URL に `zoom.us/j/` を含む | videoUrl |
| Teams | URL に `teams.microsoft.com` を含む | videoUrl |

**ビデオリンク抽出優先順位**：
1. conferenceData.entryPoints の video タイプリンク
2. hangoutLink（旧バージョン互換）

---

### 3.3 ポップアップ通知

**トリガー条件**：
- ミーティング開始90秒前
- 同一ミーティングは1回のみ（重複防止）
- ユーザーが能動的に閉じる/参加していない

**ポップアップ内容**：
- タイトル：「ミーティングが始まります」
- ミーティングタイトル
- カウントダウン（秒）
- 「今すぐ参加」ボタン
- 「キャンセル」ボタン

**ユーザー操作**：
- 「今すぐ参加」クリック：ビデオ会議リンクを開いて、ポップアップを閉じる
- 「キャンセル」クリック：ポップアップを閉じる、以降通知に影響なし
- カウントダウン終了時：自動的に閉じる

---

### 3.4 更新メカニズム

**トリガー方法**：
1. トレイpopup内の更新ボタン（手動）
2. 自動更新（一定間隔）
3. アプリ起動時の初回読み込み

---

## 4. 設計制約

### 4.1 タイムゾーン制約

- デフォルトタイムゾーン：Asia/Tokyo
- イベント時間はすべてこのタイムゾーンで処理・表示

---
